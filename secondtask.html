<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Nested Checkbox</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        .category {
            margin-top: 10px;
        }

        .items {
            margin-left: 20px;
        }

        label {
            display: block;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <h2>Nested Checkbox</h2>


    <label>
        <input type="checkbox" id="selectAll">
        Select All
    </label>


    <div class="category">
        <label>
            <input type="checkbox" class="category-checkbox" data-category="fruits">
            Fruits
        </label>
        <div class="items">
            <label><input type="checkbox" class="fruit"> Apple</label>
            <label><input type="checkbox" class="fruit"> Banana</label>
            <label><input type="checkbox" class="fruit"> Orange</label>
        </div>
    </div>


    <div class="category">
        <label>
            <input type="checkbox" class="category-checkbox" data-category="vegetables">
            Vegetables
        </label>
        <div class="items">
            <label><input type="checkbox" class="vegetable"> Carrot</label>
            <label><input type="checkbox" class="vegetable"> Broccoli</label>
            <label><input type="checkbox" class="vegetable"> Potato</label>
        </div>
    </div>


    <script>
        const selectAll = document.getElementById("selectAll");
        const categoryCheckboxes = document.querySelectorAll(".category-checkbox");
        const fruits = document.querySelectorAll(".fruit");
        const vegetables = document.querySelectorAll(".vegetable");

        // Select All → check/uncheck everything
        selectAll.addEventListener("change", (e) => {
            const checked = e.target.checked;
            selectAll.indeterminate = false; // reset dash when user clicks
            [...categoryCheckboxes, ...fruits, ...vegetables].forEach(cb => cb.checked = checked);
        });

        // Category → check/uncheck its items
        categoryCheckboxes.forEach(cb => {
            cb.addEventListener("change", (e) => {
                const checked = e.target.checked;
                const category = e.target.dataset.category;

                if (category === "fruits") {
                    fruits.forEach(f => f.checked = checked);
                } else if (category === "vegetables") {
                    vegetables.forEach(v => v.checked = checked);
                }

                updateCategory("fruits", fruits);
                updateCategory("vegetables", vegetables);
                updateSelectAll();
            });
        });

        // Items → update category & select all
        [...fruits, ...vegetables].forEach(cb => {
            cb.addEventListener("change", () => {
                updateCategory("fruits", fruits);
                updateCategory("vegetables", vegetables);
                updateSelectAll();
            });
        });

        // Update category checkbox with indeterminate support
        function updateCategory(category, items) {
            const categoryBox = document.querySelector(`.category-checkbox[data-category="${category}"]`);
            const allChecked = [...items].every(i => i.checked);
            const someChecked = [...items].some(i => i.checked);

            categoryBox.checked = allChecked;
            categoryBox.indeterminate = !allChecked && someChecked;
        }

        // Update selectAll with indeterminate support
        function updateSelectAll() {
            const allItems = [...fruits, ...vegetables];
            const allChecked = allItems.every(i => i.checked);
            const someChecked = allItems.some(i => i.checked);

            selectAll.checked = allChecked;
            selectAll.indeterminate = !allChecked && someChecked;
        }
    </script>
</body>

</html>
